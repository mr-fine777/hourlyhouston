<!DOCTYPE HTML>
<html lang="en">
<head>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="styles.css">
	<title>Hourly Houston</title>
	<meta name="description" content="Get updated content for Houston Hourly!">
	<meta name="author" content="Hourly Houston">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8">
	<link rel="icon" href="img/ico.png" media="(prefers-color-scheme: light)">
	<link rel="icon" href="img/icoW.png" media="(prefers-color-scheme: dark)">
</head>
<body>
	<!-- Mobile menu toggle: button-driven accessible drawer (replaces checkbox pattern) -->
<header class="site-header">
  <div class="header-left">
    <img src="img/icoW.png" alt="Hourly Houston logo" class="logo">
    <h2 class="site-title">Hourly Houston</h2>
  </div>

  <div class="header-right">
		<a href="#" class="cta-link" aria-label="Test">
			<button class="btn">Test</button>
		</a>
        	<!-- hamburger button: toggles the drawer on small screens -->
        	<button class="hamburger" aria-label="Open menu" aria-controls="drawer" aria-expanded="false" title="Open menu"><span class="bar"></span></button>
  </div>
</header>
<!-- clickable backdrop: clicking will close the drawer -->
<div class="backdrop" aria-hidden="true"></div>
<div class="hero-container">
  <div class="hero-body">
	<div class="hero">
		<img src="https://s.hdnux.com/photos/01/54/64/35/28526417/3/ratio3x2_960.webp" alt="This Is It Soul Food" />
		<h1>This Is It Soul Food closes historic Third Ward location after 66 years</h1>
		<p>But it's not the end for this Black-owned Houston restaurant.</p>
		<h4>TIME</h4>
	</div>
	<div class="recent-post-tier">
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="story-card">
			<img src="https://pomf2.lain.la/f/hiqorfij.jpg">
			<h1>Story Title</h1>
			<p>The sleek design of the new smartphone offers a stylish solution for tech enthusiasts, combining cutting-edge features with user-friendly functionality. Its vibrant display and powerful battery ensure that users stay connected and engaged throughout the day.</p>
		</div>
		<div class="page-holding">
		<div class="page-indexer">
			<button class="arrow left">&#8592;</button>
			<span class="page-number">Page 1</span>
			<button class="arrow right">&#8594;</button>
		</div>
		</div>
	</div>
  </div>
	<div class="hero-side" id="drawer" role="dialog" aria-modal="true" aria-hidden="true">
		<button class="drawer-close" aria-label="Close menu">×</button>
	<h2 id="timer" style="font-size: 32px; text-align: center; color: white;">00:00xm</h2>
    <div class="weather-card">
	<h1>Downtown Houston</h1>
	<h2 id="77002">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Midtown</h1>
	<h2 id="77006">00°</h2>
	</div>
	<div class="weather-card">
	<h1>The Woodlands</h1>
	<h2 id="77380">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Spring</h1>
	<h2 id="77373">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Kingwood</h1>
	<h2 id="77339">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Memorial</h1>
	<h2 id="77024">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Katy</h1>
	<h2 id="77493">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Pearland</h1>
	<h2 id="77584">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Sugar Land</h1>
	<h2 id="77478">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Pasadena</h1>
	<h2 id="77502">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Baytown</h1>
	<h2 id="77520">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Humble</h1>
	<h2 id="77338">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Galveston</h1>
	<h2 id="77550">00°</h2>
	</div>
	<div class="weather-card">
	<h1>La Porte</h1>
	<h2 id="77571">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Conroe</h1>
	<h2 id="77301">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Tomball</h1>
	<h2 id="77375">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Cypress</h1>
	<h2 id="77429">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Missouri City</h1>
	<h2 id="77459">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Stafford</h1>
	<h2 id="77477">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Seabrook</h1>
	<h2 id="77586">00°</h2>
	</div>
	<div class="weather-card">
	<h1>League City</h1>
	<h2 id="77573">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Huffman</h1>
	<h2 id="77336">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Atascocita</h1>
	<h2 id="77346">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Briarforest</h1>
	<h2 id="77077">00°</h2>
	</div>
	<div class="weather-card">
	<h1>Channelview</h1>
	<h2 id="77530">00°</h2>
	</div>
	<div class="side-ad-card">
	
	</div>
  </div>
</div>
<script>
// Drawer behavior, focus management, ESC handling, swipe-to-close and backdrop handling
;(function(){
	const drawer = document.getElementById('drawer');
	const backdrop = document.querySelector('.backdrop');
	const openBtn = document.querySelector('.hamburger');
	const closeBtn = document.querySelector('.drawer-close');
	if(!drawer || !openBtn) return;

	let lastFocused = null;

	function isSmallViewport(){ return window.matchMedia && window.matchMedia('(max-width: 520px)').matches; }

	function lockScroll(){
		if(!isSmallViewport()) return;
		const scrollY = window.scrollY || document.documentElement.scrollTop || 0;
		document.body.dataset.scrollY = String(scrollY);
		document.body.style.position = 'fixed';
		document.body.style.top = `-${scrollY}px`;
		document.body.style.left = '0';
		document.body.style.right = '0';
		document.body.style.width = '100%';
		document.body.classList.add('no-scroll');
	}

	function unlockScroll(){
		const prev = document.body.dataset.scrollY ? parseInt(document.body.dataset.scrollY, 10) : 0;
		document.body.style.position = '';
		document.body.style.top = '';
		document.body.style.left = '';
		document.body.style.right = '';
		document.body.style.width = '';
		delete document.body.dataset.scrollY;
		document.body.classList.remove('no-scroll');
		window.scrollTo(0, prev);
	}

	function openDrawer(){
		lastFocused = document.activeElement;
		document.body.classList.add('menu-open');
		drawer.setAttribute('aria-hidden', 'false');
		openBtn.setAttribute('aria-expanded', 'true');
		if(backdrop) backdrop.setAttribute('aria-hidden', 'false');
		lockScroll();
		// move focus to the first focusable element inside the drawer (close button)
		const focusable = drawer.querySelector('button, [href], input, textarea, select, [tabindex]:not([tabindex="-1"])');
		(focusable || drawer).focus();
		// trap focus
		document.addEventListener('focus', trapFocus, true);
		document.addEventListener('keydown', onKeyDown, true);
	}

	function closeDrawer(){
		document.body.classList.remove('menu-open');
		drawer.setAttribute('aria-hidden', 'true');
		openBtn.setAttribute('aria-expanded', 'false');
		if(backdrop) backdrop.setAttribute('aria-hidden', 'true');
		unlockScroll();
		document.removeEventListener('focus', trapFocus, true);
		document.removeEventListener('keydown', onKeyDown, true);
		if(lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus();
	}

	function onKeyDown(e){
		if(e.key === 'Escape') { closeDrawer(); }
		if(e.key === 'Tab') { maintainFocus(e); }
	}

	function trapFocus(e){
		if(!drawer.contains(e.target) && document.body.classList.contains('menu-open')){
			e.stopPropagation();
			drawer.querySelector('button, [href], input, textarea, select')?.focus();
		}
	}

	function maintainFocus(e){
		const focusable = Array.from(drawer.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(Boolean);
		if(!focusable.length) return;
		const first = focusable[0];
		const last = focusable[focusable.length - 1];
		if(e.shiftKey && document.activeElement === first){
			e.preventDefault(); last.focus();
		} else if(!e.shiftKey && document.activeElement === last){
			e.preventDefault(); first.focus();
		}
	}

	// open/close handlers
	openBtn.addEventListener('click', function(){
		if(document.body.classList.contains('menu-open')) closeDrawer(); else openDrawer();
	});
	if(closeBtn) closeBtn.addEventListener('click', closeDrawer);
	if(backdrop) backdrop.addEventListener('click', closeDrawer);

	// close on resize to larger viewports
	function syncOnResize(){ if(!isSmallViewport() && document.body.classList.contains('menu-open')) closeDrawer(); }
	window.addEventListener('resize', syncOnResize);
	window.addEventListener('orientationchange', syncOnResize);

	// Swipe-to-close on drawer (touch)
	let startX = null; let startY = null;
	const threshold = 40; const restraint = 120;
	drawer.addEventListener('touchstart', function(e){ const t = e.changedTouches[0]; startX = t.pageX; startY = t.pageY; }, {passive:true});
	drawer.addEventListener('touchend', function(e){ if(startX === null) return; const t = e.changedTouches[0]; const distX = t.pageX - startX; const distY = Math.abs(t.pageY - startY); if(distX > threshold && distY < restraint){ closeDrawer(); } startX = null; startY = null; }, {passive:true});

    // Timer functionality for Central Daylight Time (CDT)
    function updateTimer() {
        const timerElement = document.getElementById('timer');
        if (!timerElement) return;

        // Get the current time in CDT
        const now = new Date();
        const options = { timeZone: 'America/Chicago', hour: '2-digit', minute: '2-digit', hour12: true };
        const timeString = new Intl.DateTimeFormat('en-US', options).format(now);

        // Update the timer element
        timerElement.textContent = timeString;
    }

    // Update the timer every second
    setInterval(updateTimer, 1000);
    updateTimer();

    // Weather functionality using NWS API
    const zipToLatLon = {
        '77002': { lat: 29.752552016514958, lon: -95.37041452085252 }, // Downtown Houston
		'77006': { lat: 29.743058828618043, lon: -95.38872535855693 }, // Midtown
        '77380': { lat: 30.156561330335677, lon: -95.49660348630132 }, // The Woodlands
        '77373': { lat: 30.060076989444728, lon: -95.38425991103118 }, // Spring
        '77339': { lat: 30.044222740754748, lon: -95.21623381365497 }, // Kingwood
        '77024': { lat: 29.785061559286614, lon: -95.55081109649475 }, // Memorial
        '77493': { lat: 29.86892877253447, lon: -95.83598143772524 }, // Katy
        '77584': { lat: 29.530560656795313, lon: -95.32129891012985 }, // Pearland
        '77478': { lat: 29.619364025666467, lon: -95.60777755914671 }, // Sugar Land
        '77502': { lat: 29.68279320790105, lon: -95.2012332550293 }, // Pasadena
        '77520': { lat: 29.729931184106412, lon: -94.98634034561468 }, // Baytown
        '77338': { lat: 29.936252806244546, lon: -95.22575025287787 }, // Humble
        '77550': { lat: 29.3056910729656, lon: -94.79363293237242 }, // Galveston
        '77571': { lat: 29.681951027430866, lon: -95.0504713333233 }, // La Porte
        '77301': { lat: 30.372421017538844, lon: -95.45451089868827 }, // Conroe
        '77375': { lat: 30.11186355029859, lon: -95.58409952099358 }, // Tomball
        '77429': { lat: 30.014649608810636, lon: -95.66645508653544 }, // Cypress
        '77459': { lat: 29.478751988175286, lon: -95.52957848248982 }, // Missouri City
        '77477': { lat: 29.622026902031646, lon: -95.56770250882548 }, // Stafford
        '77586': { lat: 29.583383471744852, lon: -95.0348656373267 }, // Seabrook
        '77573': { lat: 29.495046460629094, lon: -95.09075177952913 }, // League City
        '77336': { lat: 30.074194329781477, lon: -95.09146031763426 }, // Huffman
        '77346': { lat: 29.998823130908438, lon: -95.17521190149226 }, // Atascocita
        '77077': { lat: 29.748046372801, lon: -95.62195225406828 }, // Briarforest
        '77530': { lat: 29.79477265921269, lon: -95.1119367314215 }  // Channelview
    };

    async function fetchWeatherNWS(lat, lon) {
        const url = `https://api.weather.gov/points/${lat},${lon}`;
        try {
            // Fetch the forecast URL from the NWS API
            const response = await fetch(url);
            if (!response.ok) throw new Error(`Failed to fetch weather for ${lat},${lon}: ${response.statusText}`);
            const data = await response.json();

            // Use the hourly forecast URL to get the actual weather data
            const hourlyForecastUrl = data.properties.forecastHourly;
            const hourlyResponse = await fetch(hourlyForecastUrl);
            if (!hourlyResponse.ok) throw new Error(`Failed to fetch hourly forecast: ${hourlyResponse.statusText}`);
            const hourlyData = await hourlyResponse.json();

            // Get the current hour's temperature
            const now = new Date();
            const currentHour = hourlyData.properties.periods.find(period => {
                const startTime = new Date(period.startTime);
                const endTime = new Date(period.endTime);
                return now >= startTime && now <= endTime;
            });

            if (currentHour) {
                return currentHour.temperature; // Temperature in Fahrenheit
            } else {
                throw new Error('No hourly forecast data available for the current time.');
            }
        } catch (error) {
            console.error(`Error fetching weather for ${lat},${lon}:`, error);
            return null;
        }
    }

    async function updateWeather() {
        for (const [zip, { lat, lon }] of Object.entries(zipToLatLon)) {
            const temp = await fetchWeatherNWS(lat, lon);
            const weatherElement = document.getElementById(zip);
            if (weatherElement && temp !== null) {
                weatherElement.textContent = `${temp}°F`;
            }
        }
    }

    // Fetch and update weather data
    updateWeather();

})();
</script>
</body>
</html>
